# æœåŠ¡å™¨è®­ç»ƒå‘½ä»¤è¯´æ˜

## âš ï¸ é—®é¢˜è¯Šæ–­

å¦‚æœé‡åˆ°ä»¥ä¸‹é”™è¯¯ï¼š
```
train_3d.py: error: unrecognized arguments: --data_dir
```

è¯´æ˜æœåŠ¡å™¨ä¸Šçš„ä»£ç å¯èƒ½æ˜¯æ—§ç‰ˆæœ¬ï¼Œä½¿ç”¨çš„æ˜¯ `--valid_images_3d_file` å‚æ•°ã€‚

## ğŸ”§ è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1ï¼šæ›´æ–°æœåŠ¡å™¨ä»£ç ï¼ˆæ¨èï¼‰

å°†æœ€æ–°çš„ `train_3d.py` ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œç¡®ä¿ä½¿ç”¨ `--data_dir` å‚æ•°ã€‚

### æ–¹æ¡ˆ2ï¼šä½¿ç”¨æ—§ç‰ˆæœ¬å‚æ•°ï¼ˆä¸´æ—¶æ–¹æ¡ˆï¼‰

å¦‚æœæœåŠ¡å™¨ä»£ç æš‚æ—¶æ— æ³•æ›´æ–°ï¼Œå¯ä»¥æ£€æŸ¥æœåŠ¡å™¨ä¸Šçš„å®é™…å‚æ•°ï¼š

```bash
# æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯ï¼Œç¡®è®¤å®é™…å‚æ•°
python train_transformer3D/train_3d.py --help
```

#### å¦‚æœæœåŠ¡å™¨ä½¿ç”¨æ—§ç‰ˆæœ¬ï¼ˆvalid_images_3d_fileï¼‰

éœ€è¦å…ˆè¿è¡Œæ•°æ®æå–è„šæœ¬ç”Ÿæˆ `valid_images_3d.json`ï¼š

```bash
# 1. æå–æ•°æ®ï¼ˆå¦‚æœè¿˜æ²¡åšï¼‰
python train_transformer3D/extract_and_align_3d_data.py \
    --face_dir train/datas/face \
    --video_dir train/datas/video \
    --output_dir train/datas/file

# 2. ç„¶åä½¿ç”¨æ—§ç‰ˆæœ¬å‚æ•°è®­ç»ƒï¼ˆéœ€è¦å…ˆè½¬æ¢æ•°æ®æ ¼å¼ï¼‰
# æ³¨æ„ï¼šè¿™éœ€è¦é¢å¤–çš„æ•°æ®è½¬æ¢æ­¥éª¤
```

**å»ºè®®**ï¼šæ›´æ–°æœåŠ¡å™¨ä»£ç åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œä½¿ç”¨ `--data_dir` å‚æ•°ã€‚

## âœ… æ­£ç¡®çš„è®­ç»ƒå‘½ä»¤ï¼ˆæœ€æ–°ç‰ˆæœ¬ï¼‰

### åŸºç¡€è®­ç»ƒ

```bash
python train_transformer3D/train_3d.py \
    --data_dir train/datas/file \
    --batch_size 32 \
    --epochs 100
```

### å®Œæ•´å‚æ•°è®­ç»ƒ

```bash
python train_transformer3D/train_3d.py \
    --data_dir train/datas/file \
    --batch_size 32 \
    --num_workers 4 \
    --d_model 512 \
    --nhead 8 \
    --num_layers 4 \
    --dim_feedforward 2048 \
    --dropout 0.1 \
    --use_spatial_attention \
    --use_pose_attention \
    --epochs 100 \
    --lr 1e-4 \
    --weight_decay 1e-5 \
    --loss_type combined \
    --save_dir train_transformer3D/checkpoints \
    --log_dir train_transformer3D/logs
```

### Windows/Linux è·¯å¾„æ ¼å¼

```bash
# Linux/æœåŠ¡å™¨ï¼ˆä½¿ç”¨æ­£æ–œæ ï¼‰
python train_transformer3D/train_3d.py \
    --data_dir train/datas/file \
    --batch_size 32

# æˆ–è€…ä½¿ç”¨ç»å¯¹è·¯å¾„
python train_transformer3D/train_3d.py \
    --data_dir /root/face000/train/datas/file \
    --batch_size 32
```

## ğŸ” æ£€æŸ¥ä»£ç ç‰ˆæœ¬

åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œä»¥ä¸‹å‘½ä»¤æ£€æŸ¥å‚æ•°ï¼š

```bash
# æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯
python train_transformer3D/train_3d.py --help
```

**æœŸæœ›è¾“å‡º**ï¼ˆæœ€æ–°ç‰ˆæœ¬ï¼‰ï¼š
```
--data_dir DATA_DIR  æ•°æ®ç›®å½•ï¼ˆåŒ…å«front_*.npyå’Œvideo_*.npyæ–‡ä»¶ï¼‰
```

**æ—§ç‰ˆæœ¬è¾“å‡º**ï¼š
```
--valid_images_3d_file VALID_IMAGES_3D_FILE  åŒ…å«3Då…³é”®ç‚¹å’Œå§¿æ€çš„JSONæ–‡ä»¶è·¯å¾„
```

## ğŸ“ æ›´æ–°æ­¥éª¤

å¦‚æœæœåŠ¡å™¨ä»£ç æ˜¯æ—§ç‰ˆæœ¬ï¼Œéœ€è¦ï¼š

1. å°†æœ€æ–°çš„ `train_transformer3D/train_3d.py` ä¸Šä¼ åˆ°æœåŠ¡å™¨
2. ç¡®ä¿ `train_transformer3D/dataset.py` å­˜åœ¨ï¼ˆæ–°ç‰ˆæœ¬æ•°æ®é›†ï¼‰
3. ç¡®ä¿æ•°æ®å·²æå–åˆ° `train/datas/file/` ç›®å½•
4. ä½¿ç”¨ `--data_dir` å‚æ•°è®­ç»ƒ

## ğŸš€ å¿«é€Ÿæµ‹è¯•

```bash
# æµ‹è¯•æ•°æ®åŠ è½½
python train_transformer3D/train_3d.py \
    --data_dir train/datas/file \
    --batch_size 4 \
    --epochs 1 \
    --num_workers 0
```

å¦‚æœè¿™ä¸ªå‘½ä»¤èƒ½è¿è¡Œï¼Œè¯´æ˜ä»£ç å·²æ›´æ–°æˆåŠŸã€‚
